-- AULA 26/08
-- DECLARE
-- Declarando variáveis
DECLARE @valor INT,
		@texto VARCHAR(40),
		@data_nasc DATE,
		@dinheiro MONEY;

-- SET / SELECT
-- Setando os valores das variáveis
SET @valor = 23;
SET @texto = 'Camille da Silva Rodrigues';
SET @data_nasc = GETDATE();
SET @dinheiro = 50.50;

-- Exibir os valores armazenados nas variáveis
SELECT  @valor AS 'Idade', 
		@texto AS 'Nome', 
		@data_nasc AS 'U_Acesso',
		@dinheiro AS 'V.Compra';

-- PRINT
PRINT 'O valor contido na variável @texto é: ' + @texto;
PRINT 'O valor contido na variável @valor é: ' + CAST(@valor AS VARCHAR(10));

-- BANCO EMPRESA
-- (1)
DECLARE @dpt_num INT;
SET @dpt_num = 4;

SELECT *
FROM DEPARTAMENTO AS D
WHERE D.Dnumero = @dpt_num;

-- (2)
-- SELECT para a inserção de valores em uma variável
DECLARE @nome VARCHAR(40),
		@salario MONEY,
		@porcentagem DECIMAL(10, 2),
		@novo_salario MONEY;
SET @nome = 'Jennifer';
SET @porcentagem = 10;

SELECT @salario = F.salario
FROM FUNCIONARIO AS F
WHERE F.Pnome = @nome;

SET @novo_salario = @salario*(1+@porcentagem/100);

SELECT @nome AS 'Nome', 
	   @salario AS 'Salario',
	   @porcentagem AS '%', @novo_salario AS 'Novo_Salario';

-- (3) Continuação em ELSE IF
DECLARE @idade INT,
		@nome_pessoa VARCHAR(100),
		@ano_atual INT,
		@ano_nasc INT;
SET @nome_pessoa = 'Jennifer';
SET @ano_atual = YEAR(GETDATE());

SELECT @ano_nasc = YEAR(F.Datanasc)
FROM FUNCIONARIO AS F
WHERE F.Pnome = @nome_pessoa;

SET @idade = @ano_atual - @ano_nasc;
PRINT 'A ' + @nome_pessoa +  ' tem ' + CAST(@idade AS VARCHAR(2)) + ' anos';

-- CONCAT
-- CONCAT OS VARCHAR
SELECT CONCAT (F.Pnome,' ', F.Minicial, '. ', F.Unome) AS 'Nome completo'
FROM FUNCIONARIO AS F

-- IF E ELSE
DECLARE @salario Decimal (10,2), 
		@salario_medio Decimal (10,2),
		@nome_funcionario VARCHAR (100); 
SET @nome_funcionario = 'Jennifer';

SELECT @salario = F.Salario 
FROM FUNCIONARIO AS F
WHERE F.Pnome = @nome_funcionario;

SELECT @salario_medio = AVG(F.Salario)  
FROM FUNCIONARIO AS F;

PRINT @salario_medio;
PRINT @salario;

IF @salario > @salario_medio
	BEGIN 
		PRINT 'FUNCIONARIO GANHA MAIS QUE A MEDIA'
	END
ELSE
	BEGIN
		PRINT 'FUNCIONARIO NÃO GANHA MAIS QUE A MEIDA'
	END

DECLARE @nome_funcionario varchar(100),
		@idade int;
SET @nome_funcionario = 'Jennifer';

SELECT @idade = DATEDIFF(YEAR, F.Datanasc, GETDATE())
FROM FUNCIONARIO AS F
WHERE F.Pnome = 'Jennifer';
PRINT @idade;

IF @idade >= 80
	BEGIN
		PRINT 'Já passou a hora de se aposentar'
	END
ELSE IF @idade >= 60
	BEGIN
		PRINT 'Próximo a aposentadoria'
	end
ELSE 
	BEGIN
		PRINT 'Não esta apto'
	END

DECLARE @nome_funcionario VARCHAR (100),
		@datanasc DATE;
SET @nome_funcionario = 'Jennifer';

SELECT @datanasc = f.Datanasc
FROM FUNCIONARIO AS f
WHERE f.Pnome = @nome_funcionario;

IF MONTH(GETDATE()) < MONTH(@datanasc) AND DAY(GETDATE()) < DAY(@datanasc) 
   PRINT DATEDIFF(YEAR,@datanasc, GETDATE());							  
   PRINT DATEDIFF(YEAR,@datanasc, GETDATE())-1;
